<?php header('X-XSS-Protection:0')?>
<body onload="init()">
<style>
  ul {
    margin:0;
  }
</style>

<script>
  function init(){
    document.getElementById('please_wait').style.display='none';
  }
</script>

<!doctype html>
<a href="..">Home</a>
<h2>4. Generating ecospold file</h2>

<small id=please_wait>Please wait...</small>

<?php
  //receive OS command from POST[input] to invoke python
  $cmd=isset($_POST['input']) ? $_POST['input'] : './test.py a b c d';
?>

<!--shell prompt -->
  <form method=POST style=display:none>$
  <input name=input id=input value="<?php echo $cmd?>"
    placeholder="write command here" style="width:50%">
  </form>

<!--show cmd
<?php
  $formatted_cmd = strlen($cmd)>140 ? substr($cmd,0,140)."..." : $cmd;
  echo "<b><code>&gt; $formatted_cmd</code></b>";
?>
-->

<!--cmd output generated by shell-->
<pre style="background:#eee;padding:8px"><code><?php
  //var_dump(shell_exec($cmd." 2>&1"));
  $exportPath='export PATH=/home/clients/4dd5f0e34c312c0032584b62dbe7ba8e/opt/anaconda3/bin:/usr/local/bin:$PATH';
  $result=shell_exec("$exportPath; ".$cmd.' 2>&1'); //need to add the path of "python3"
  echo $result;
?>
</code></pre>

<!--focus on cmd prompt-->
<script>document.querySelector('#input').select();</script>
